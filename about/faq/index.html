



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-0.17.2, mkdocs-material-2.6.0">
    
    
      
        <title>Frequently Asked Questions - Beam Documentation</title>
      
    
    

      <link rel="stylesheet" href="../../assets/stylesheets/application.aa3de92b.css">
      
    
<link rel="stylesheet" type="text/css" href="../../css/beam.css"/>

    
      <script src="../../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
      <link rel="stylesheet" href="../../docs/theme/css/beam.css">
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <a href="#how-does-beam-compare-with-x" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../.." title="Beam Documentation" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                Beam Documentation
              </span>
              <span class="md-header-nav__topic">
                Frequently Asked Questions
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/tathougies/beam/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      tathougies/beam
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    <span class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </span>
    Beam Documentation
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/tathougies/beam/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      tathougies/beam
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        Frequently Asked Questions
      </label>
    
    <a href="./" title="Frequently Asked Questions" class="md-nav__link md-nav__link--active">
      Frequently Asked Questions
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#how-does-beam-compare-with-x" title="How does beam compare with &lt;x&gt;?" class="md-nav__link">
    How does beam compare with &lt;x&gt;?
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#opaleye" title="opaleye" class="md-nav__link">
    opaleye
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#persistentesqueleto" title="persistent/esqueleto" class="md-nav__link">
    persistent/esqueleto
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#groundhog" title="groundhog" class="md-nav__link">
    groundhog
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hasql" title="hasql" class="md-nav__link">
    hasql
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#selda" title="selda" class="md-nav__link">
    selda
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#squeal" title="squeal" class="md-nav__link">
    squeal
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#help-the-type-checker-keeps-complaining-about-syntax-types" title="Help! The type checker keeps complaining about Syntax types" class="md-nav__link">
    Help! The type checker keeps complaining about Syntax types
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#other-database-mappers-simulate-features-on-databases-that-lack-support-why-not-beam" title="Other database mappers simulate features on databases that lack support, why not beam?" class="md-nav__link">
    Other database mappers simulate features on databases that lack support, why not beam?
  </a>
  
</li>
      
      
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Tutorial
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Tutorial
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/tutorial1/" title="Part 1" class="md-nav__link">
      Part 1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/tutorial2/" title="Part 2" class="md-nav__link">
      Part 2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/tutorial3/" title="Part 3" class="md-nav__link">
      Part 3
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      User Guide
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        User Guide
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/models/" title="Models" class="md-nav__link">
      Models
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/databases/" title="Databases" class="md-nav__link">
      Databases
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/backends/" title="Backends" class="md-nav__link">
      Backends
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/expressions/" title="Expressions" class="md-nav__link">
      Expressions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-5" type="checkbox" id="nav-4-5">
    
    <label class="md-nav__link" for="nav-4-5">
      Queries
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-5">
        Queries
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/queries/basic/" title="Basic Queries" class="md-nav__link">
      Basic Queries
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/queries/select/" title="More complex SELECTs" class="md-nav__link">
      More complex SELECTs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/queries/ordering/" title="Ordering" class="md-nav__link">
      Ordering
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/queries/relationships/" title="Relationships" class="md-nav__link">
      Relationships
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/queries/aggregates/" title="Aggregates" class="md-nav__link">
      Aggregates
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/queries/combining-queries/" title="Combining queries" class="md-nav__link">
      Combining queries
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/queries/window-functions/" title="Window functions" class="md-nav__link">
      Window functions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/queries/advanced-features/" title="Advanced features" class="md-nav__link">
      Advanced features
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/extensibility/" title="Custom queries" class="md-nav__link">
      Custom queries
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-7" type="checkbox" id="nav-4-7">
    
    <label class="md-nav__link" for="nav-4-7">
      Data Manipulation
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-7">
        Data Manipulation
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/manipulation/insert/" title="INSERT" class="md-nav__link">
      INSERT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/manipulation/update/" title="UPDATE" class="md-nav__link">
      UPDATE
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/manipulation/delete/" title="DELETE" class="md-nav__link">
      DELETE
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Schema management
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Schema management
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../schema-guide/migrations/" title="The Migrations Framework" class="md-nav__link">
      The Migrations Framework
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../schema-guide/tool/" title="The beam-migrate tool" class="md-nav__link">
      The beam-migrate tool
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../schema-guide/supported/" title="Supported migrations" class="md-nav__link">
      Supported migrations
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Backends
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Backends
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/backends/beam-postgres/" title="beam-postgres" class="md-nav__link">
      beam-postgres
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/backends/beam-sqlite/" title="beam-sqlite" class="md-nav__link">
      beam-sqlite
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/custom-backends/" title="Writing a Custom Backend" class="md-nav__link">
      Writing a Custom Backend
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      About
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        About
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../compatibility/" title="Compatibility Matrix" class="md-nav__link">
      Compatibility Matrix
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../license/" title="License" class="md-nav__link">
      License
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../release-notes/" title="Release Notes" class="md-nav__link">
      Release Notes
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#how-does-beam-compare-with-x" title="How does beam compare with &lt;x&gt;?" class="md-nav__link">
    How does beam compare with &lt;x&gt;?
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#opaleye" title="opaleye" class="md-nav__link">
    opaleye
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#persistentesqueleto" title="persistent/esqueleto" class="md-nav__link">
    persistent/esqueleto
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#groundhog" title="groundhog" class="md-nav__link">
    groundhog
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hasql" title="hasql" class="md-nav__link">
    hasql
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#selda" title="selda" class="md-nav__link">
    selda
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#squeal" title="squeal" class="md-nav__link">
    squeal
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#help-the-type-checker-keeps-complaining-about-syntax-types" title="Help! The type checker keeps complaining about Syntax types" class="md-nav__link">
    Help! The type checker keeps complaining about Syntax types
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#other-database-mappers-simulate-features-on-databases-that-lack-support-why-not-beam" title="Other database mappers simulate features on databases that lack support, why not beam?" class="md-nav__link">
    Other database mappers simulate features on databases that lack support, why not beam?
  </a>
  
</li>
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/tathougies/beam/edit/master/docs/about/faq.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                  <h1>Frequently Asked Questions</h1>
                
                <h2 id="how-does-beam-compare-with-x">How does <code>beam</code> compare with <code>&lt;x&gt;</code>?</h2>
<h3 id="opaleye"><code>opaleye</code></h3>
<p><code>opaleye</code> has similar aims as beam. However, <code>beam</code>'s DSL is monadic,
and eschews the use of arrows. We use a phantom scope parameter to
achieve the same result (it's the <code>s</code> parameter in the <code>Q</code> and <code>QExpr</code>
types). This allows you to write queries in the same way you'd use the
list monad. Some people think this is more intuitive than arrows.</p>
<p>Beam also uses higher-kinded types to allow the use of 'normal'
haskell data types, rather than a fully polymorphic type. For example,
in opaleye you may have to write</p>
<div class="codehilite"><pre><span></span><span class="kr">data</span> <span class="kt">Table</span> <span class="n">column1</span> <span class="n">column2</span> <span class="n">column3</span> <span class="ow">=</span>
  <span class="kt">Table</span> <span class="p">{</span> <span class="n">tblColumn1</span> <span class="ow">::</span> <span class="n">column1</span>
        <span class="p">,</span> <span class="n">tblColumn2</span> <span class="ow">::</span> <span class="n">column2</span>
        <span class="p">,</span> <span class="n">tblColumn3</span> <span class="ow">::</span> <span class="n">column3</span>
        <span class="p">}</span>
</pre></div>


<p>This can get tiring when you have dozens of columns. In beam, types
need only take one polymorphic parameter.</p>
<div class="codehilite"><pre><span></span><span class="kr">data</span> <span class="kt">Table</span> <span class="n">f</span> <span class="ow">=</span>
  <span class="kt">Table</span> <span class="p">{</span> <span class="n">tblColumn1</span> <span class="ow">::</span> <span class="kt">C</span> <span class="n">f</span> <span class="kt">Column1Type</span>
        <span class="p">,</span> <span class="n">tblColumn2</span> <span class="ow">::</span> <span class="kt">C</span> <span class="n">f</span> <span class="kt">Column2Type</span>
        <span class="p">,</span> <span class="n">tblColumn3</span> <span class="ow">::</span> <span class="kt">C</span> <span class="n">f</span> <span class="kt">Column3Type</span>
        <span class="p">}</span> <span class="kr">deriving</span> <span class="p">(</span><span class="kt">Generic</span><span class="p">,</span> <span class="kt">Beamable</span><span class="p">)</span>
</pre></div>


<p>Moreover, all beam instances and type synonyms are easily written by
hand. There is no Template Haskell magic here. What you see is what
you get.</p>
<p>Beam is also fully polymorphic over the backend. That is to say
that a beam query can be written once and used across multiple
backends, so long as those backends support the features used in the
query. Feature constraints are written as class constraints. For
example, if you write a query that uses the SQL standard <code>regr_slope</code>
function, you can make that query polymorphic over a choice in backend
by using the
<code>IsSql2003EnhancedNumericFunctionsAggregationExpressionSyntax</code>
class. You can freely mix and match backends at any time (well, within
the realms of possibility in terms of Haskell polymorphism). For
example, the <code>beam-migrate</code> CLI tool loads backends at run-time and
issues queries against them, without knowing the specifics of any
particular backend.</p>
<p>Finally, beam produces readable queries. Here is what opaleye produces on a left join:</p>
<div class="codehilite"><pre><span></span>personBirthdayLeftJoin :: Query ((Column PGText, Column PGInt4, Column PGText),
                                 ColumnNullableBirthday)
personBirthdayLeftJoin = leftJoin personQuery birthdayQuery eqName
    where eqName ((name, _, _), birthdayRow) = name .== bdName birthdayRow

The generated SQL is
ghci&gt; printSql personBirthdayLeftJoin
SELECT result1_0_3 as result1,
       result1_1_3 as result2,
       result1_2_3 as result3,
       result2_0_3 as result4,
       result2_1_3 as result5
FROM (SELECT *
      FROM (SELECT name0_1 as result1_0_3,
                   age1_1 as result1_1_3,
                   address2_1 as result1_2_3,
                   name0_2 as result2_0_3,
                   birthday1_2 as result2_1_3
            FROM
            (SELECT *
             FROM (SELECT name as name0_1,
                          age as age1_1,
                          address as address2_1
                   FROM personTable as T1) as T1) as T1
            LEFT OUTER JOIN
            (SELECT *
             FROM (SELECT name as name0_2,
                          birthday as birthday1_2
                   FROM birthdayTable as T1) as T1) as T2
            ON
            (name0_1) = (name0_2)) as T1) as T1
</pre></div>


<p>A similar query in beam:</p>
<p>
                <div class="code-nav-container">
                    
        <ul class="nav nav-tabs">
            
        <li class="nav-item">
            <a href="#tab-0-Haskell" aria-controls="tab-0-Haskell" role="tab" data-toggle="tab" data-lang="haskell">Haskell</a>
        </li>
    
        <li class="nav-item">
            <a href="#tab-0-Sqlite" aria-controls="tab-0-Sqlite" role="tab" data-toggle="tab" data-lang="sql">Sqlite</a>
        </li>
    
        <li class="nav-item">
            <a href="#tab-0-Postgres" aria-controls="tab-0-Postgres" role="tab" data-toggle="tab" data-lang="sql">Postgres</a>
        </li>
    
        <li class="nav-item">
            <a href="#tab-0-Mysql" aria-controls="tab-0-Mysql" role="tab" data-toggle="tab" data-lang="sql">Mysql</a>
        </li>
    
        </ul>
    
        <div class="tab-content">
            
        <div role="tabpanel" class="tab-pane active" id="tab-0-Haskell">
            <div class="codehilite"><pre><span></span><span class="kr">do</span> <span class="n">artist</span> <span class="ow">&lt;-</span> <span class="n">all_</span> <span class="p">(</span><span class="n">artist</span> <span class="n">chinookDb</span><span class="p">)</span>
   <span class="n">album</span>  <span class="ow">&lt;-</span> <span class="n">leftJoin_</span> <span class="p">(</span><span class="n">all_</span> <span class="p">(</span><span class="n">album</span> <span class="n">chinookDb</span><span class="p">))</span> <span class="p">(</span><span class="nf">\</span><span class="n">album</span> <span class="ow">-&gt;</span> <span class="n">albumArtist</span> <span class="n">album</span> <span class="o">==.</span> <span class="n">primaryKey</span> <span class="n">artist</span><span class="p">)</span>
   <span class="n">pure</span> <span class="p">(</span><span class="n">artist</span><span class="p">,</span> <span class="n">album</span><span class="p">)</span>
</pre></div>

        </div>
    
        <div role="tabpanel" class="tab-pane " id="tab-0-Sqlite">
            <div class="codehilite"><pre><span></span><span class="k">SELECT</span> <span class="ss">&quot;t0&quot;</span><span class="p">.</span><span class="ss">&quot;ArtistId&quot;</span> <span class="k">AS</span> <span class="ss">&quot;res0&quot;</span><span class="p">,</span>
       <span class="ss">&quot;t0&quot;</span><span class="p">.</span><span class="ss">&quot;Name&quot;</span> <span class="k">AS</span> <span class="ss">&quot;res1&quot;</span><span class="p">,</span>
       <span class="ss">&quot;t1&quot;</span><span class="p">.</span><span class="ss">&quot;AlbumId&quot;</span> <span class="k">AS</span> <span class="ss">&quot;res2&quot;</span><span class="p">,</span>
       <span class="ss">&quot;t1&quot;</span><span class="p">.</span><span class="ss">&quot;Title&quot;</span> <span class="k">AS</span> <span class="ss">&quot;res3&quot;</span><span class="p">,</span>
       <span class="ss">&quot;t1&quot;</span><span class="p">.</span><span class="ss">&quot;ArtistId&quot;</span> <span class="k">AS</span> <span class="ss">&quot;res4&quot;</span>
<span class="k">FROM</span> <span class="ss">&quot;Artist&quot;</span> <span class="k">AS</span> <span class="ss">&quot;t0&quot;</span>
<span class="k">LEFT</span> <span class="k">JOIN</span> <span class="ss">&quot;Album&quot;</span> <span class="k">AS</span> <span class="ss">&quot;t1&quot;</span> <span class="k">ON</span> <span class="p">(</span><span class="ss">&quot;t1&quot;</span><span class="p">.</span><span class="ss">&quot;ArtistId&quot;</span><span class="p">)</span><span class="o">=</span><span class="p">(</span><span class="ss">&quot;t0&quot;</span><span class="p">.</span><span class="ss">&quot;ArtistId&quot;</span><span class="p">);</span>

<span class="c1">-- With values: []</span>
</pre></div>

        </div>
    
        <div role="tabpanel" class="tab-pane " id="tab-0-Postgres">
            <div class="codehilite"><pre><span></span><span class="k">SELECT</span> <span class="ss">&quot;t0&quot;</span><span class="p">.</span><span class="ss">&quot;ArtistId&quot;</span> <span class="k">AS</span> <span class="ss">&quot;res0&quot;</span><span class="p">,</span>
       <span class="ss">&quot;t0&quot;</span><span class="p">.</span><span class="ss">&quot;Name&quot;</span> <span class="k">AS</span> <span class="ss">&quot;res1&quot;</span><span class="p">,</span>
       <span class="ss">&quot;t1&quot;</span><span class="p">.</span><span class="ss">&quot;AlbumId&quot;</span> <span class="k">AS</span> <span class="ss">&quot;res2&quot;</span><span class="p">,</span>
       <span class="ss">&quot;t1&quot;</span><span class="p">.</span><span class="ss">&quot;Title&quot;</span> <span class="k">AS</span> <span class="ss">&quot;res3&quot;</span><span class="p">,</span>
       <span class="ss">&quot;t1&quot;</span><span class="p">.</span><span class="ss">&quot;ArtistId&quot;</span> <span class="k">AS</span> <span class="ss">&quot;res4&quot;</span>
<span class="k">FROM</span> <span class="ss">&quot;Artist&quot;</span> <span class="k">AS</span> <span class="ss">&quot;t0&quot;</span>
<span class="k">LEFT</span> <span class="k">JOIN</span> <span class="ss">&quot;Album&quot;</span> <span class="k">AS</span> <span class="ss">&quot;t1&quot;</span> <span class="k">ON</span> <span class="p">(</span><span class="ss">&quot;t1&quot;</span><span class="p">.</span><span class="ss">&quot;ArtistId&quot;</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="ss">&quot;t0&quot;</span><span class="p">.</span><span class="ss">&quot;ArtistId&quot;</span><span class="p">)</span>
</pre></div>

        </div>
    
        <div role="tabpanel" class="tab-pane " id="tab-0-Mysql">
            <div class="codehilite"><pre><span></span><span class="k">SELECT</span> <span class="o">`</span><span class="n">t0</span><span class="o">`</span><span class="p">.</span><span class="o">`</span><span class="n">ArtistId</span><span class="o">`</span> <span class="k">AS</span> <span class="o">`</span><span class="n">res0</span><span class="o">`</span><span class="p">,</span>
       <span class="o">`</span><span class="n">t0</span><span class="o">`</span><span class="p">.</span><span class="o">`</span><span class="n">Name</span><span class="o">`</span> <span class="k">AS</span> <span class="o">`</span><span class="n">res1</span><span class="o">`</span><span class="p">,</span>
       <span class="o">`</span><span class="n">t1</span><span class="o">`</span><span class="p">.</span><span class="o">`</span><span class="n">AlbumId</span><span class="o">`</span> <span class="k">AS</span> <span class="o">`</span><span class="n">res2</span><span class="o">`</span><span class="p">,</span>
       <span class="o">`</span><span class="n">t1</span><span class="o">`</span><span class="p">.</span><span class="o">`</span><span class="n">Title</span><span class="o">`</span> <span class="k">AS</span> <span class="o">`</span><span class="n">res3</span><span class="o">`</span><span class="p">,</span>
       <span class="o">`</span><span class="n">t1</span><span class="o">`</span><span class="p">.</span><span class="o">`</span><span class="n">ArtistId</span><span class="o">`</span> <span class="k">AS</span> <span class="o">`</span><span class="n">res4</span><span class="o">`</span>
<span class="k">FROM</span> <span class="o">`</span><span class="n">Artist</span><span class="o">`</span> <span class="k">AS</span> <span class="o">`</span><span class="n">t0</span><span class="o">`</span>
<span class="k">LEFT</span> <span class="k">JOIN</span> <span class="o">`</span><span class="n">Album</span><span class="o">`</span> <span class="k">AS</span> <span class="o">`</span><span class="n">t1</span><span class="o">`</span> <span class="k">ON</span> <span class="p">(</span><span class="o">`</span><span class="n">t1</span><span class="o">`</span><span class="p">.</span><span class="o">`</span><span class="n">ArtistId</span><span class="o">`</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="o">`</span><span class="n">t0</span><span class="o">`</span><span class="p">.</span><span class="o">`</span><span class="n">ArtistId</span><span class="o">`</span><span class="p">)</span>
</pre></div>

        </div>
    
        </div>
    
                </div>
                    </p>
<h3 id="persistentesqueleto"><code>persistent</code>/<code>esqueleto</code></h3>
<p>Persistent is a simple relational mapper for Haskell. Like beam, it
also supports multiple backends. However, unlike <code>beam</code>, it does not
offer a DSL for expressing joins or complex queries. Many people use
the <code>esqueleto</code> library to add these features to persistent. However,
<code>esqueleto</code> allows a number of constructs to compile that lead to
run-time errors. In particular, join <code>ON</code> conditions need to match the
order specified in the <code>FROM</code> clause, but this is not checked at
compile time. In contrast, beam handles this for you. If the query
compiles, it will generate proper code.</p>
<p>Moreover, beam's approach is more flexible. <code>Esqueleto</code> relies on
pre-defined algebraic data types. Beam uses a finally tagless encoding
so that external packages can provide completely new
functionality. For example, <code>beam-postgres</code> is packaged independently
of <code>beam-core</code> and offers several advanced features, such as row-level
locking, JSON support, etc, without requiring any changes to core
modules. An OpenGIS package is also in the works, and beam's approach
means this will be packaged separately from core.</p>
<h3 id="groundhog"><code>groundhog</code></h3>
<h3 id="hasql"><code>hasql</code></h3>
<p><code>hasql</code> is a library offering compile-time checking of queries using a
quasiquoter. It's really great if you want to write your own SQL query
and embed it in your Haskell source. However, it cannot check that the
shape of the data returned by the query matches what your code
expects. For example, if you issue a command <code>SELECT a, b, c, d, e</code>,
but then unpack a 6-tuple in your Haskell code, this will lead to a
run-time error. Beam is much more heavy weight but guarantees that the
shape of data matches. Also, beam allows you to write and compose
queries in a very straightforward Haskell style, that is more
expressive than vanilla SQL.</p>
<h3 id="selda"><code>selda</code></h3>
<p><code>selda</code> has similar aims as beam. However, beam encourages the use of
Haskell record types, whereas selda has its own type-level combinators
for constructing table types. This makes it more straightforward to
use beam types in pre-existing applications.</p>
<p>Beam also has more robust support for migrations. Beam backends
typically map more features than selda ones.</p>
<h3 id="squeal"><code>squeal</code></h3>
<h2 id="help-the-type-checker-keeps-complaining-about-syntax-types">Help! The type checker keeps complaining about <code>Syntax</code> types</h2>
<p>Suppose you had the following code to run a query over an arbitrary backend that
supported the SQL92 syntax.</p>
<div class="codehilite"><pre><span></span><span class="nf">listEmployees</span> <span class="ow">::</span> <span class="p">(</span><span class="kt">IsSql92Syntax</span> <span class="n">cmd</span><span class="p">,</span> <span class="kt">MonadBeam</span> <span class="n">cmd</span> <span class="n">be</span> <span class="n">hdl</span> <span class="n">m</span><span class="p">)</span> <span class="ow">=&gt;</span> <span class="n">m</span> <span class="p">[</span><span class="kt">Employee</span><span class="p">]</span>
<span class="nf">listEmployees</span> <span class="ow">=</span> <span class="n">runSelectReturningList</span> <span class="o">$</span> <span class="n">select</span> <span class="p">(</span><span class="n">all_</span> <span class="p">(</span><span class="n">employees</span> <span class="n">employeeDb</span><span class="p">))</span>
</pre></div>


<p>You may get an error message like the following</p>
<div class="codehilite"><pre><span></span>MyQueries.hs:1:1: error:
    * Could not deduce: Sql92ProjectionExpressionSyntax
                          (Sql92SelectTableProjectionSyntax
                             (Sql92SelectSelectTableSyntax (Sql92SelectSyntax cmd)))
                        ~
                        Sql92SelectTableExpressionSyntax
                          (Sql92SelectSelectTableSyntax (Sql92SelectSyntax cmd))
        arising from a use of &#39;select&#39;
</pre></div>


<p>Beam uses a <a href="http://okmij.org/ftp/tagless-final/JFP.pdf">finally-tagless</a>
encoding for syntaxes. This means we never deal with concrete syntax types
internally, just types that fulfill certain constraints (in this case, being a
valid description of a SQL92 syntax). This works really nicely for
extensibility, but makes the types slightly confusing. Here, the type checker is
complaining that it cannot prove that the type of expressions used in
projections is the same as the type of expressions used in <code>WHERE</code> and <code>HAVING</code>
clauses. Of course, any sane SQL92 syntax would indeed meet this criteria, but
this criteria is difficult to enforce at the type class level (it leads to
cycles in superclasses, which requires the scary-looking
<code>UndecidableSuperclasses</code> extension in GHC).</p>
<p>Nevertheless, we can avoid all this hullabaloo by using the <code>Sql92SanityCheck</code>
constraint synonym. This takes a command syntax and asserts all the type
equalities that a sane SQL92 syntax would support. Thus the code above becomes.</p>
<div class="codehilite"><pre><span></span><span class="nf">listEmployees</span> <span class="ow">::</span> <span class="p">(</span> <span class="kt">IsSql92Syntax</span> <span class="n">cmd</span><span class="p">,</span> <span class="kt">Sql92SanityCheck</span> <span class="n">cmd</span>
                 <span class="p">,</span> <span class="kt">MonadBeam</span> <span class="n">cmd</span> <span class="n">be</span> <span class="n">hdl</span> <span class="n">m</span><span class="p">)</span>
              <span class="ow">=&gt;</span> <span class="n">m</span> <span class="p">[</span><span class="kt">Employee</span><span class="p">]</span>
<span class="nf">listEmployees</span> <span class="ow">=</span> <span class="n">runSelectReturningList</span> <span class="o">$</span> <span class="n">select</span> <span class="p">(</span><span class="n">all_</span> <span class="p">(</span><span class="n">employees</span> <span class="n">employeeDb</span><span class="p">))</span>
</pre></div>


<h2 id="other-database-mappers-simulate-features-on-databases-that-lack-support-why-not-beam">Other database mappers simulate features on databases that lack support, why not beam?</h2>
<p>Beam assumes that the developer has picked their RDBMS for a reason. Beam does
not try to take on features of the RDBMS, because often there is no reasonable
and equally performant substitution that can be made. Beam tries to follow the
principle of least surprise -- the SQL queries beam generates should be easily
guessable from the Haskell query DSL (modulo aliasing). Generating complicated
emulation code which can result in unpredictable performance would violate this
principle.</p>
                
                  
                
              
              
                
              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../.." title="Home" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Home
              </span>
            </div>
          </a>
        
        
          <a href="../../tutorials/tutorial1/" title="Part 1" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Part 1
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="http://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    

      <script src="../../assets/javascripts/application.9fb73e57.js"></script>
      
      <script>app.initialize({version:"0.17.2",url:{base:"../.."}})</script>
      
    
<script type="text/javascript" language="javascript"  src="https://code.jquery.com/jquery-2.2.4.min.js"></script>
<script type="text/javascript" language="javascript" src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<script type="text/javascript" language="javascript">
 $(document.body).tab();
 $(".nav-item:first-child").tab("show");
</script>

    
      
    
  </body>
</html>